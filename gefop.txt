local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TextBoxButton = Instance.new("TextButton")
local GotopartButton = Instance.new("TextButton")
local CreateSPButton = Instance.new("TextButton")
local DestroyESPButton = Instance.new("TextButton")
local MinimizeButton = Instance.new("TextButton")
local highlightTransparency = 0.5
local gotopartDelay = 0.1
local isMinimized = false

local colors = {
    Color3.new(1, 0, 0),
    Color3.new(0, 1, 0),
    Color3.new(0, 0, 1),
    Color3.fromRGB(255, 165, 0),
    Color3.new(1, 1, 1),
    Color3.fromRGB(255, 192, 203),
    Color3.fromRGB(128, 0, 128),
    Color3.fromRGB(255, 255, 0),
    Color3.fromRGB(0, 255, 255),
}

local function getRandomColor()
    return colors[math.random(1, #colors)]
end

local function getRoot(character)
    if character:FindFirstChild("HumanoidRootPart") then
        return character.HumanoidRootPart
    else
        return character.PrimaryPart or character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
    end
end

local function findPlayerByName(playerName)
    playerName = playerName:lower()
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player.Name:lower():match(playerName) then
            return player
        end
    end
    return nil
end

local function findPartByName(partName)
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and obj.Name:lower() == partName:lower() then
            return obj
        end
    end
    return nil
end

local function Createesp(part, color)
    local existingESP = part:FindFirstChild("ESP")
    if existingESP then
        print("ESP atau highlight dengan nama '"..part.Name.."' sudah ada.")
        return
    end
    
    local esp = Instance.new("BoxHandleAdornment")
    esp.Name = "ESP"
    esp.Adornee = part
    esp.Size = part.Size
    esp.Color3 = color
    esp.AlwaysOnTop = true
    esp.Transparency = highlightTransparency
    esp.ZIndex = 5
    esp.Parent = part
end

local function CreateFloatingHighlight(part)
    local floatingText = Instance.new("BillboardGui")
    floatingText.Name = "FloatingText"
    floatingText.Size = UDim2.new(0, 200, 0, 50)
    floatingText.StudsOffset = Vector3.new(0, 3, 0)
    floatingText.AlwaysOnTop = true

    local textLabel = Instance.new("TextLabel")
    textLabel.Name = "NameLabel"
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundColor3 = Color3.new(1, 1, 1)
    textLabel.BackgroundTransparency = 1
    textLabel.TextColor3 = Color3.new(1, 1, 1)
    textLabel.TextStrokeTransparency = 0.5
    textLabel.TextScaled = true
    textLabel.Font = Enum.Font.SourceSansBold
    textLabel.Text = part.Name
    textLabel.Parent = floatingText

    floatingText.Parent = part
end

local function DestroyAllESP()
    for _, part in ipairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") and part:FindFirstChild("ESP") then
            part.ESP:Destroy()
        end
        if part:IsA("BillboardGui") and part.Name == "FloatingText" then
            part:Destroy()
        end
    end
    print("Semua ESP, highlight, dan floating text telah dihapus.")
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MyGui"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.ResetOnSpawn = false

local MainFrame = Instance.new("MainFrame")
MainFrame.Size = UDim2.new(0.4, 0, 0.3, 0)
MainFrame.Position = UDim2.new(0.5, 0, 0.05, 0)
MainFrame.BackgroundColor3 = Color3.fromHSV(tick() % 5 / 5, 1, 1) -- สีรุ้ง
MainFrame.BorderSizePixel = 0
MainFrame.Parent = screenGui
MainFrame.Active = true
MainFrame.Draggable = true

local textbox = Instance.new("TextBox")
textbox.Size = UDim2.new(0.8, 0, 0.1, 0)
textbox.Position = UDim2.new(0.1, 0, 0.1, 0)
textbox.BackgroundColor3 = Color3.new(1, 1, 1)
textbox.BorderSizePixel = 0
textbox.Text = "Partname or (Player can short)"
textbox.Parent = Mainframe

local gotopartButton = Instance.new("TextButton")
gotopartButton.Name = "Gotopart"
gotopartButton.Size = UDim2.new(0.4, 0, 0.1, 0)
gotopartButton.Position = UDim2.new(0.1, 0, 0.25, 0)
gotopartButton.BackgroundColor3 = Color3.new(0, 0, 1)
gotopartButton.TextColor3 = Color3.new(1, 1, 1)
gotopartButton.Text = "Gotopart"
gotopartButton.BorderSizePixel = 0
gotopartButton.Parent = MainFrame

local createspButton = Instance.new("TextButton")
createspButton.Name = "Createsp"
createspButton.Size = UDim2.new(0.4, 0, 0.1, 0)
createspButton.Position = UDim2.new(0.55, 0, 0.25, 0)
createspButton.BackgroundColor3 = Color3.new(0, 0, 1)
createspButton.TextColor3 = Color3.new(1, 1, 1)
createspButton.Text = "Createsp"
createspButton.BorderSizePixel = 0
createspButton.Parent = MainFrame

local gotoplayerButton = Instance.new("TextButton")
gotoplayerButton.Name = "Gotoplayer"
gotoplayerButton.Size = UDim2.new(0.4, 0, 0.1, 0)
gotoplayerButton.Position = UDim2.new(0.1, 0, 0.45, 0)
gotoplayerButton.BackgroundColor3 = Color3.new(0, 0, 1)
gotoplayerButton.TextColor3 = Color3.new(1, 1, 1)
gotoplayerButton.Text = "Gotoplayer"
gotoplayerButton.BorderSizePixel = 0
gotoplayerButton.Parent = MainFrame

local destroyespButton = Instance.new("TextButton")
destroyespButton.Name = "DestroyESP"
destroyespButton.Size = UDim2.new(0.4, 0, 0.1, 0)
destroyespButton.Position = UDim2.new(0.1, 0, 0.75, 0)
destroyespButton.BackgroundColor3 = Color3.new(0, 0, 1)
destroyespButton.TextColor3 = Color3.new(1, 1, 1)
destroyespButton.Text = "DestroyESP"
destroyespButton.BorderSizePixel = 0
destroyespButton.Parent = MainFrame

local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "Minimize"
minimizeButton.Size = UDim2.new(0.3, 0, 0.1, 0)
minimizeButton.Position = UDim2.new(0.1, 0, 0.9, 0)
minimizeButton.BackgroundColor3 = Color3.new(0, 0, 1)
minimizeButton.TextColor3 = Color3.new(1, 1, 1)
minimizeButton.Text = "Minimize"
minimizeButton.BorderSizePixel = 0
minimizeButton.Parent = frame

local function ToggleElements(visible)
    textbox.Visible = visible
    MainFrame.Visible = visible
    gotopartButton.Visible = visible
    createspButton.Visible = visible
    gotoplayerButton.Visible = visible
    destroyespButton.Visible = visible
end

local function ToggleButtons()
    if isminimized then
        ToggleElements(true)
    else
        ToggleElements(false)
    end
end

minimizeButton.MouseButton1Click:Connect(function()
    isminimized = not isminimized
    ToggleButtons()
end)

gotopartButton.MouseButton1Click:Connect(function()
    local partName = textbox.Text
    local part = findPartByName(partName)
    if part then
        getRoot(game.Players.LocalPlayer.Character).CFrame = part.CFrame
        print("Last Gotopart: "..partName)
    else
        print("Tidak dapat menemukan part dengan nama '"..partName.."'.")
    end
end)

createspButton.MouseButton1Click:Connect(function()
    local partName = textbox.Text
    local part = findPartByName(partName)
    if part then
        local randomColor = getRandomColor()
        CreateESP(part, randomColor)
        CreateFloatingHighlight(part)
        print("Created ESP atau highlight: "..partName)
    else
        print("Tidak dapat menemukan part dengan nama '"..partName.."'.")
    end
end)

gotoplayerButton.MouseButton1Click:Connect(function()
    local playerName = textbox.Text
    local player = findPlayerByName(playerName)
    if player then
        getRoot(game.Players.LocalPlayer.Character).CFrame = player.Character.HumanoidRootPart.CFrame
        print("Last Gotoplayer: "..player.Name)
    else
        print("Tidak dapat menemukan pemain dengan nama '"..playerName.."'.")
    end
end)

destroyespButton.MouseButton1Click:Connect(function()
    DestroyAllESP()
end)

game:GetService("RunService").Heartbeat:Connect(function()
    MainFrame.BackgroundColor3 = Color3.fromHSV(tick() % 5 / 5, 1, 1)
end)

ToggleFrame(true)
